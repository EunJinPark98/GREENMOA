<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{fragment/main_layout}">
<head>
<meta charset="UTF-8">
<title></title>
</head>
<body>
    <th:block layout:fragment="content" style="height: 1000px;">
      <link rel="stylesheet" href="/css/main.css">


      <!-- 클래스룸 -->
      <div id="classRoom">
        <div class="row" style="height: 100%;">
          <div class="col">
            <!-- 선생님 미니미 -->
            <div class="teacher">
              <img th:src="|/images/${teacher.minime}.png|">
              <p class="name">[[${teacher.memberName}]]</p>
            </div>
            <!-- 출석부 -->
            <div class="student-list" data-bs-toggle="modal" data-bs-target="#stuListModal"><img src="/images/studentList.png" alt=""></div>
            <!-- 학생 미니미 -->
	          <div class="mini-fr">
              <th:block th:if="${memberList} != null">
                <th:block th:each="member : ${memberList}">
                  <div class="member">
                    <!-- 미니미 말풍선 -->
                    <div class="minmeBubble"><p class="letterText" data-bs-toggle="modal" data-bs-target="#letterModal">쪽지보내기</p></div>

                    <!-- 미니미 -->
                    <img class="minime-img" th:src="|/images/${member.minime}.png|">
                    <p class="name">[[${member.memberName}]]</p>
                  </div>
                </th:block>
              </th:block>
            </div>

            <!-- 과제 -->
            <div class="work-icon" data-bs-toggle="modal" data-bs-target="#workModal">과제</div>
            <div class="work-btn bounce" data-bs-toggle="modal" data-bs-target="#workModal">과제</div>

            <!-- 캘린더 -->
            <div class="pin">핀셋</div>
            <a class="calendar" data-bs-toggle="modal" data-bs-target="#calenderModal">캘린더</a>
          </div>
        </div>
      </div>

      <!-- 쪽지 보내기 모달창 -->
      <div class="modal fade" id="letterModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
      aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body modal-body">
                  <div class="letter">
                    <h3>쪽지보내기</h3>
                    <form action="/room/insertLetter" method="post">
                        <div>
                            <label for="formId">보내는 사람</label>
                            <input type="text" id="formId" name="formId">
                        </div>
                        <div>
                            <label for="memberId">받는 사람</label>
                            <input type="text" id="memberId" name="memberId">
                        </div>
                        <div>
                            <label for="letterContet">메세지</label>
                            <textarea id="letterContet" name="letterContent"></textarea>
                        </div>
                        <ul>
                            <li><input type="submit" class="btn btn-primary" value="보내기"></li>
                            <li><input type="button" class="btn btn-secondary" data-bs-dismiss="modal" value="닫기"></li>
                        </ul>
                    </form>
                </div>
                </div>
            </div>
        </div>
    </div>
      

      <!-- 채팅 -->
      <div class="row">
        <div class="col">
          <th:block th:if="${session.loginInfo}!=null">
            <input id="sender" type="hidden" th:attr="data-sender=${session.loginInfo.memberName}">
          </th:block>

          <div id="chat" class="container-md">
              <h3>채팅</h3>
              <div id="chat-messages"></div>

              <form id="message-form">
                  <input type="text" id="message" class="form-control">
                  <button type="submit" id="chatBtn" class="btn btn-primary">전송</button>
              </form>
          </div>
        </div>
      </div>

     



        <!-- 출석부 모달 -->
        <div class="modal fade" id="stuListModal" tabindex="-1" aria-labelledby="stuListModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="stu-modal-content modal-content">
            <div class="stu-modal-header modal-header">
              <h1 class="modal-title fs-5" id="stuListModalLabel">출석부</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <img class="stu-list-pen" src="/images/black_pen.png" alt="">

              <th:block th:if="${memberList} != null">
                  <table class="table">
                    <thead class="stu-thead">
                      <tr>
                        <th scope="col">no</th>
                        <th scope="col">아이디</th>
                        <th scope="col">이름</th>
                        <th scope="col">성별</th>
                        <th scope="col">생년월일</th>
                      </tr>
                    </thead>
                    <tbody class="stu-tbody table-group-divider" th:each="member, state : ${memberList}">
                      <tr>
                        <td>[[${state.index + 1}]]</td>
                        <td>[[${member.memberId}]]</td>
                        <td>[[${member.memberName}]]</td>
                        <td>[[${member.memberGender}]]</td>
                        <td>[[${member.memberBirthday}]]</td>
                      </tr>
                    </tbody>
                  </table>
              </th:block>
            </div>
          </div>
        </div>
      </div>


      <!-- 과제 모달 -->
      <div class="modal fade" id="workModal" tabindex="-1" aria-labelledby="workModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="workModalLabel">과제</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              과제리스트
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
              <button type="button" class="btn btn-primary">과제 등록</button>
            </div>
          </div>
        </div>
      </div>


      <!-- 캘린더 모달 -->
      <div class="modal fade" id="calenderModal" tabindex="-1" aria-labelledby="calenderModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="calenderModalLabel">캘린더</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              
            </div>
          </div>
        </div>
      </div>


      
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="/js/room.js"></script>
        <!-- WebSocket 및 채팅 로직을 초기화하는 스크립트 추가 -->
        <script src="/webjars/sockjs-client/1.1.2/sockjs.min.js"></script>
        <script src="/js/chat.js"></script>
    </th:block>
</body>
</html>